{"ast":null,"code":"// kanban-gui-test/src/components/FlyingCardAnimation.js\nimport React,{useEffect,useRef,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";const FlyingCardAnimation=_ref=>{let{card,startRect,endRect,onAnimationEnd}=_ref;const animatedRef=useRef(null);const animationInstanceRef=useRef(null);useEffect(()=>{if(!animatedRef.current||!startRect||!endRect){return;}if(animationInstanceRef.current){return;}console.log(`[FlyingCardAnimation] Karte ${card.id}: Starting animation from (${startRect.left},${startRect.top}) to (${endRect.left},${endRect.top})`);const deltaX=endRect.left-startRect.left;const deltaY=endRect.top-startRect.top;const keyframes=[{transform:'translate(0, 0)',opacity:1},{transform:`translate(${deltaX}px, ${deltaY}px)`,opacity:1}];const options={duration:500,easing:'ease-in-out',fill:'forwards'};animationInstanceRef.current=animatedRef.current.animate(keyframes,options);animationInstanceRef.current.finished.then(()=>{console.log(`[FlyingCardAnimation] Promise-based animation finished for Karte: ${card.id}`);onAnimationEnd(card.id);}).catch(error=>{if(error.name==='AbortError'){console.log(`[FlyingCardAnimation] Karte ${card.id}: Animation was cancelled.`);}else{console.error(`[FlyingCardAnimation] Karte ${card.id}: Animation error:`,error);}});const fallbackTimeout=setTimeout(()=>{if(animationInstanceRef.current&&animationInstanceRef.current.playState!=='finished'&&animationInstanceRef.current.playState!=='idle'){console.warn(`[FlyingCardAnimation] Fallback: Animation for Karte ${card.id} did not finish (playState: ${animationInstanceRef.current.playState}). Forcing cleanup.`);onAnimationEnd(card.id);animationInstanceRef.current.cancel();}},options.duration+200);return()=>{if(animationInstanceRef.current){animationInstanceRef.current.cancel();}clearTimeout(fallbackTimeout);};},[card.id,startRect,endRect,onAnimationEnd]);return/*#__PURE__*/_jsx(\"div\",{ref:animatedRef// CRITICAL CHANGE: Remove conflicting Tailwind classes like p-4, mb-3.\n// Keep only essential visual (non-sizing/non-text) classes.\n// bg-white, rounded, shadow-md are okay.\n,className:\"bg-white rounded shadow-md pointer-events-none\"// Removed p-4, mb-3\n,style:{position:'fixed',left:startRect?startRect.left:0,top:startRect?startRect.top:0,// CRITICAL: Ensure width and height are from startRect for the clone's initial size\nwidth:startRect?startRect.width:0,// Apply width from startRect\nheight:startRect?startRect.height:0,// Apply height from startRect\nzIndex:1000,opacity:startRect?1:0,// Start opaque if startRect is available\n// Manually apply padding, font size, and text wrapping rules here to match the resting card\npadding:'4px 6px',// Matches the Card component's padding\nfontSize:'0.75rem',// Matches the Card component's font size\ntextAlign:'center',// Center text\ndisplay:'flex',// Use flexbox for centering content\njustifyContent:'center',// Center horizontally\nalignItems:'center',// Center vertically\nwhiteSpace:'nowrap',// Prevent text wrapping (fixes carriage return)\noverflow:'hidden',// Hide text that overflows\ntextOverflow:'ellipsis'// Add \"...\" for hidden text (optional, but good UX)\n},children:card.birth_id?`Karte ${card.birth_id}`:card.id});};export default FlyingCardAnimation;","map":{"version":3,"names":["React","useEffect","useRef","useState","jsx","_jsx","FlyingCardAnimation","_ref","card","startRect","endRect","onAnimationEnd","animatedRef","animationInstanceRef","current","console","log","id","left","top","deltaX","deltaY","keyframes","transform","opacity","options","duration","easing","fill","animate","finished","then","catch","error","name","fallbackTimeout","setTimeout","playState","warn","cancel","clearTimeout","ref","className","style","position","width","height","zIndex","padding","fontSize","textAlign","display","justifyContent","alignItems","whiteSpace","overflow","textOverflow","children","birth_id"],"sources":["/Users/ralf/PyPrograms/KanbanFlow-Web/kanban-gui-test/src/components/FlyingCardAnimation.js"],"sourcesContent":["// kanban-gui-test/src/components/FlyingCardAnimation.js\n\nimport React, { useEffect, useRef, useState } from 'react';\n\nconst FlyingCardAnimation = ({ card, startRect, endRect, onAnimationEnd }) => {\n  const animatedRef = useRef(null);\n  const animationInstanceRef = useRef(null);\n\n  useEffect(() => {\n    if (!animatedRef.current || !startRect || !endRect) {\n        return;\n    }\n\n    if (animationInstanceRef.current) {\n        return;\n    }\n\n    console.log(`[FlyingCardAnimation] Karte ${card.id}: Starting animation from (${startRect.left},${startRect.top}) to (${endRect.left},${endRect.top})`);\n\n    const deltaX = endRect.left - startRect.left;\n    const deltaY = endRect.top - startRect.top;\n\n    const keyframes = [\n      { transform: 'translate(0, 0)', opacity: 1 },\n      { transform: `translate(${deltaX}px, ${deltaY}px)`, opacity: 1 },\n    ];\n\n    const options = {\n      duration: 500,\n      easing: 'ease-in-out',\n      fill: 'forwards',\n    };\n\n    animationInstanceRef.current = animatedRef.current.animate(keyframes, options);\n\n    animationInstanceRef.current.finished.then(() => {\n      console.log(`[FlyingCardAnimation] Promise-based animation finished for Karte: ${card.id}`);\n      onAnimationEnd(card.id);\n    }).catch(error => {\n      if (error.name === 'AbortError') {\n        console.log(`[FlyingCardAnimation] Karte ${card.id}: Animation was cancelled.`);\n      } else {\n        console.error(`[FlyingCardAnimation] Karte ${card.id}: Animation error:`, error);\n      }\n    });\n\n    const fallbackTimeout = setTimeout(() => {\n        if (animationInstanceRef.current && animationInstanceRef.current.playState !== 'finished' && animationInstanceRef.current.playState !== 'idle') {\n            console.warn(`[FlyingCardAnimation] Fallback: Animation for Karte ${card.id} did not finish (playState: ${animationInstanceRef.current.playState}). Forcing cleanup.`);\n            onAnimationEnd(card.id);\n            animationInstanceRef.current.cancel();\n        }\n    }, options.duration + 200);\n\n    return () => {\n      if (animationInstanceRef.current) {\n        animationInstanceRef.current.cancel();\n      }\n      clearTimeout(fallbackTimeout);\n    };\n  }, [card.id, startRect, endRect, onAnimationEnd]);\n\n  return (\n    <div\n      ref={animatedRef}\n      // CRITICAL CHANGE: Remove conflicting Tailwind classes like p-4, mb-3.\n      // Keep only essential visual (non-sizing/non-text) classes.\n      // bg-white, rounded, shadow-md are okay.\n      className=\"bg-white rounded shadow-md pointer-events-none\" // Removed p-4, mb-3\n      style={{\n        position: 'fixed',\n        left: startRect ? startRect.left : 0,\n        top: startRect ? startRect.top : 0,\n        // CRITICAL: Ensure width and height are from startRect for the clone's initial size\n        width: startRect ? startRect.width : 0,  // Apply width from startRect\n        height: startRect ? startRect.height : 0, // Apply height from startRect\n        zIndex: 1000,\n        opacity: startRect ? 1 : 0, // Start opaque if startRect is available\n        // Manually apply padding, font size, and text wrapping rules here to match the resting card\n        padding: '4px 6px', // Matches the Card component's padding\n        fontSize: '0.75rem', // Matches the Card component's font size\n        textAlign: 'center', // Center text\n        display: 'flex',      // Use flexbox for centering content\n        justifyContent: 'center', // Center horizontally\n        alignItems: 'center',     // Center vertically\n        whiteSpace: 'nowrap',   // Prevent text wrapping (fixes carriage return)\n        overflow: 'hidden',      // Hide text that overflows\n        textOverflow: 'ellipsis' // Add \"...\" for hidden text (optional, but good UX)\n      }}\n    >\n      {/* Ensure \"Karte\" text for gliding clone */}\n      {card.birth_id ? `Karte ${card.birth_id}` : card.id}\n    </div>\n  );\n};\n\nexport default FlyingCardAnimation;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}