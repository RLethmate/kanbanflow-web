{"ast":null,"code":"// src/components/Card.js\nimport React,{forwardRef,useCallback}from'react';// <--- Import useCallback\nimport{useDrag}from'react-dnd';import{jsx as _jsx}from\"react/jsx-runtime\";const ItemTypes={CARD:'card'};// Use forwardRef to allow parent components (like Board) to get a ref to this component's DOM node\nconst Card=/*#__PURE__*/forwardRef((_ref,ref)=>{let{id,text,laneId,index,style}=_ref;// <--- Accept style prop\nconst[{isDragging},drag]=useDrag(()=>({type:ItemTypes.CARD,item:{id,text,laneId,index},collect:monitor=>({isDragging:monitor.isDragging()})}));// NEW: Combine multiple refs into a single, robust callback ref\nconst setRefs=useCallback(node=>{// Set the external ref (the one passed from Board.js)\n// Check if 'ref' is a function (legacy ref) or an object (current ref object)\nif(typeof ref==='function'){ref(node);}else if(ref){ref.current=node;}// Set react-dnd's drag ref\n// react-dnd's 'drag' ref can be a function or an object, handle both\nif(typeof drag==='function'){drag(node);}else if(drag){drag.current=node;}// Add console log here to trace Card ref assignment\nif(node){console.log(`[Card.js] Card ${id} ref SET:`,node);}else{console.log(`[Card.js] Card ${id} ref UNSET (unmounting):`,node);}},[ref,drag,id]// Dependencies for useCallback: ensure it re-creates if these change\n);const opacity=isDragging?0.4:1;return/*#__PURE__*/_jsx(\"div\",{ref:setRefs// <--- Use the combined callback ref here\n,className:\"bg-white p-4 mb-3 rounded shadow-md cursor-grab transition-opacity duration-200 ease-in-out\",style:{...style,opacity}// <--- Apply external style prop and internal opacity\n,children:text});});export default Card;export{ItemTypes};","map":{"version":3,"names":["React","forwardRef","useCallback","useDrag","jsx","_jsx","ItemTypes","CARD","Card","_ref","ref","id","text","laneId","index","style","isDragging","drag","type","item","collect","monitor","setRefs","node","current","console","log","opacity","className","children"],"sources":["/Users/ralf/PyPrograms/KanbanFlow-Web/kanban-gui-test/src/components/Card.js"],"sourcesContent":["// src/components/Card.js\nimport React, { forwardRef, useCallback } from 'react'; // <--- Import useCallback\nimport { useDrag } from 'react-dnd';\n\nconst ItemTypes = {\n  CARD: 'card',\n};\n\n// Use forwardRef to allow parent components (like Board) to get a ref to this component's DOM node\nconst Card = forwardRef(({ id, text, laneId, index, style }, ref) => { // <--- Accept style prop\n  const [{ isDragging }, drag] = useDrag(() => ({\n    type: ItemTypes.CARD,\n    item: { id, text, laneId, index },\n    collect: (monitor) => ({\n      isDragging: monitor.isDragging(),\n    }),\n  }));\n\n  // NEW: Combine multiple refs into a single, robust callback ref\n  const setRefs = useCallback(\n    (node) => {\n      // Set the external ref (the one passed from Board.js)\n      // Check if 'ref' is a function (legacy ref) or an object (current ref object)\n      if (typeof ref === 'function') {\n        ref(node);\n      } else if (ref) {\n        ref.current = node;\n      }\n\n      // Set react-dnd's drag ref\n      // react-dnd's 'drag' ref can be a function or an object, handle both\n      if (typeof drag === 'function') {\n        drag(node);\n      } else if (drag) {\n        drag.current = node;\n      }\n\n      // Add console log here to trace Card ref assignment\n      if (node) {\n        console.log(`[Card.js] Card ${id} ref SET:`, node);\n      } else {\n        console.log(`[Card.js] Card ${id} ref UNSET (unmounting):`, node);\n      }\n    },\n    [ref, drag, id] // Dependencies for useCallback: ensure it re-creates if these change\n  );\n\n  const opacity = isDragging ? 0.4 : 1;\n\n  return (\n    <div\n      ref={setRefs} // <--- Use the combined callback ref here\n      className=\"bg-white p-4 mb-3 rounded shadow-md cursor-grab transition-opacity duration-200 ease-in-out\"\n      style={{ ...style, opacity }} // <--- Apply external style prop and internal opacity\n    >\n      {text}\n    </div>\n  );\n});\n\nexport default Card;\nexport { ItemTypes };"],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,UAAU,CAAEC,WAAW,KAAQ,OAAO,CAAE;AACxD,OAASC,OAAO,KAAQ,WAAW,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEpC,KAAM,CAAAC,SAAS,CAAG,CAChBC,IAAI,CAAE,MACR,CAAC,CAED;AACA,KAAM,CAAAC,IAAI,cAAGP,UAAU,CAAC,CAAAQ,IAAA,CAAqCC,GAAG,GAAK,IAA5C,CAAEC,EAAE,CAAEC,IAAI,CAAEC,MAAM,CAAEC,KAAK,CAAEC,KAAM,CAAC,CAAAN,IAAA,CAAY;AACrE,KAAM,CAAC,CAAEO,UAAW,CAAC,CAAEC,IAAI,CAAC,CAAGd,OAAO,CAAC,KAAO,CAC5Ce,IAAI,CAAEZ,SAAS,CAACC,IAAI,CACpBY,IAAI,CAAE,CAAER,EAAE,CAAEC,IAAI,CAAEC,MAAM,CAAEC,KAAM,CAAC,CACjCM,OAAO,CAAGC,OAAO,GAAM,CACrBL,UAAU,CAAEK,OAAO,CAACL,UAAU,CAAC,CACjC,CAAC,CACH,CAAC,CAAC,CAAC,CAEH;AACA,KAAM,CAAAM,OAAO,CAAGpB,WAAW,CACxBqB,IAAI,EAAK,CACR;AACA;AACA,GAAI,MAAO,CAAAb,GAAG,GAAK,UAAU,CAAE,CAC7BA,GAAG,CAACa,IAAI,CAAC,CACX,CAAC,IAAM,IAAIb,GAAG,CAAE,CACdA,GAAG,CAACc,OAAO,CAAGD,IAAI,CACpB,CAEA;AACA;AACA,GAAI,MAAO,CAAAN,IAAI,GAAK,UAAU,CAAE,CAC9BA,IAAI,CAACM,IAAI,CAAC,CACZ,CAAC,IAAM,IAAIN,IAAI,CAAE,CACfA,IAAI,CAACO,OAAO,CAAGD,IAAI,CACrB,CAEA;AACA,GAAIA,IAAI,CAAE,CACRE,OAAO,CAACC,GAAG,CAAC,kBAAkBf,EAAE,WAAW,CAAEY,IAAI,CAAC,CACpD,CAAC,IAAM,CACLE,OAAO,CAACC,GAAG,CAAC,kBAAkBf,EAAE,0BAA0B,CAAEY,IAAI,CAAC,CACnE,CACF,CAAC,CACD,CAACb,GAAG,CAAEO,IAAI,CAAEN,EAAE,CAAE;AAClB,CAAC,CAED,KAAM,CAAAgB,OAAO,CAAGX,UAAU,CAAG,GAAG,CAAG,CAAC,CAEpC,mBACEX,IAAA,QACEK,GAAG,CAAEY,OAAS;AAAA,CACdM,SAAS,CAAC,6FAA6F,CACvGb,KAAK,CAAE,CAAE,GAAGA,KAAK,CAAEY,OAAQ,CAAG;AAAA,CAAAE,QAAA,CAE7BjB,IAAI,CACF,CAAC,CAEV,CAAC,CAAC,CAEF,cAAe,CAAAJ,IAAI,CACnB,OAASF,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}