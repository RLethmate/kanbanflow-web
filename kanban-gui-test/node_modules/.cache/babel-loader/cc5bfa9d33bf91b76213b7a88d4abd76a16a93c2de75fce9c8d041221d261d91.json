{"ast":null,"code":"var _jsxFileName = \"/Users/ralf/PyPrograms/KanbanFlow-Web/kanban-gui-test/src/components/Board.js\",\n  _s = $RefreshSig$();\n// src/components/Board.js\nimport React, { useState, useCallback, useRef, useEffect } from 'react';\nimport Lane from './Lane';\nimport Card from './Card';\nimport FlyingCardAnimation from './FlyingCardAnimation';\n\n// --- API Configuration ---\n// IMPORTANT: Use your FastAPI backend URL.\n// If running locally, it's usually http://127.0.0.1:8000\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE_URL = 'http://127.0.0.1:8000';\nconst Board = () => {\n  _s();\n  // --- React State for Board and Simulation Controls ---\n  const [lanes, setLanes] = useState([]); // Initial empty lanes, will be populated from backend\n  const [dashboardData, setDashboardData] = useState([]); // For the dashboard table\n\n  // Simulation Parameters state (for user input)\n  const [complexity, setComplexity] = useState(1);\n  const [wipLimit, setWipLimit] = useState(5);\n  const [simSpeed, setSimSpeed] = useState(1.0); // In seconds per step\n\n  const [simulationRunning, setSimulationRunning] = useState(false); // Tracks backend status\n  const [currentRound, setCurrentRound] = useState(0); // Tracks backend round\n\n  const [flyingAnimations, setFlyingAnimations] = useState([]);\n\n  // Refs for card elements for gliding animation\n  const cardRefs = useRef(new Map());\n  const laneRefs = useRef(new Map());\n\n  // Board readiness for first render (from previous step)\n  const [isReady, setIsReady] = useState(false);\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      setIsReady(true);\n      console.log('Board component and initial refs are likely ready.');\n    }, 100);\n    return () => clearTimeout(timeoutId);\n  }, []);\n\n  // --- Helper to get a card by its ID from current React lanes state ---\n  const getCardById = useCallback(cardId => {\n    for (const lane of lanes) {\n      const card = lane.cards.find(c => c.id === cardId);\n      if (card) return card;\n    }\n    return null;\n  }, [lanes]);\n\n  // --- Programmatic Card Move (Gliding) ---\n  const programmaticMoveCard = useCallback((cardId, targetLaneId) => {\n    const cardElement = cardRefs.current.get(cardId);\n    const targetLaneElement = laneRefs.current.get(targetLaneId);\n    if (!cardElement || !targetLaneElement) {\n      console.warn(`[Gliding] Could not find element for card ${cardId} or lane ${targetLaneId}. Cannot animate.`);\n      return;\n    }\n    const startRect = cardElement.getBoundingClientRect();\n    const currentCardData = getCardById(cardId);\n\n    // If cardData is null (e.g. card moved off board), don't animate\n    if (!currentCardData) {\n      console.warn(`[Gliding] Card ${cardId} not found in current state, skipping animation.`);\n      return;\n    }\n    setFlyingAnimations(prev => [...prev, {\n      id: `flying-${cardId}-${Date.now()}`,\n      // Unique ID for each animation instance\n      card: currentCardData,\n      startRect: startRect\n    }]);\n\n    // Schedule getting endRect after React re-renders the actual card\n    requestAnimationFrame(() => {\n      const endCardElement = cardRefs.current.get(cardId);\n      if (endCardElement) {\n        const endRect = endCardElement.getBoundingClientRect();\n        setFlyingAnimations(prev => prev.map(anim => anim.card.id === cardId && !anim.endRect ? {\n          ...anim,\n          endRect: endRect\n        } : anim));\n      } else {\n        // If card disappeared (e.g., moved to Done and removed from board), clear animation\n        setFlyingAnimations(prev => prev.filter(anim => anim.card.id !== cardId));\n      }\n    });\n  }, [getCardById]);\n\n  // Callback for when a flying animation ends\n  const handleAnimationEnd = useCallback(animatedCardId => {\n    setFlyingAnimations(prev => prev.filter(anim => anim.card.id !== animatedCardId));\n  }, []);\n\n  // --- API Calls to Python Backend ---\n\n  const setConfig = useCallback(async () => {\n    console.log(\"setConfig: Attempting to set simulation config...\"); // NEW LOG\n    try {\n      const response = await fetch(`${API_BASE_URL}/simulation/config`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          complexity,\n          wip_limit: wipLimit,\n          speed: simSpeed\n        })\n      });\n      console.log(\"setConfig: Fetch request sent and response received.\"); // NEW LOG\n\n      const data = await response.json();\n      if (response.ok) {\n        console.log('Config set:', data);\n        //  alert('Simulation parameters updated!');\n      } else {\n        console.error('Failed to set config:', data);\n        // alert(`Error setting config: ${data.detail || 'Unknown error'}`);\n      }\n    } catch (error) {\n      console.error('Network error setting config:', error);\n      // alert('Network error: Could not connect to backend to set config.');\n    }\n  }, [complexity, wipLimit, simSpeed]);\n  const startSimulation = useCallback(async () => {\n    console.log(\"startSimulation: Attempting to start simulation...\"); // NEW LOG\n    try {\n      console.log(\"startSimulation: Calling setConfig...\"); // NEW LOG\n      // Ensure parameters are set first\n      await setConfig();\n      console.log(\"startSimulation: setConfig call finished.\"); // NEW LOG\n\n      const response = await fetch(`${API_BASE_URL}/simulation/start`, {\n        method: 'POST'\n      });\n      const data = await response.json();\n      if (response.ok) {\n        console.log('Simulation started:', data);\n        setSimulationRunning(true);\n        // alert('Simulation started!');\n      } else {\n        console.error('Failed to start simulation:', data);\n        // alert(`Error starting simulation: ${data.detail || 'Unknown error'}`);\n      }\n    } catch (error) {\n      console.error('startSimulation: Network error starting simulation or error from setConfig:', error); // NEW LOG\n\n      //  alert('Network error: Could not connect to backend to start simulation.');\n    }\n  }, [setConfig]); // Depend on setConfig\n\n  const stopSimulation = useCallback(async () => {\n    console.log(\"Stopping simulation...\");\n    try {\n      const response = await fetch(`${API_BASE_URL}/simulation/stop`, {\n        method: 'POST'\n      });\n      const data = await response.json();\n      if (response.ok) {\n        console.log('Simulation stopped:', data);\n        setSimulationRunning(false);\n        // alert('Simulation stopped!');\n      } else {\n        console.error('Failed to stop simulation:', data);\n        // alert(`Error stopping simulation: ${data.detail || 'Unknown error'}`);\n      }\n    } catch (error) {\n      console.error('Network error stopping simulation:', error);\n      // alert('Network error: Could not connect to backend to stop simulation.');\n    }\n  }, []);\n  const clearDashboard = useCallback(async () => {\n    console.log(\"Clearing dashboard...\");\n    try {\n      const response = await fetch(`${API_BASE_URL}/dashboard/clear`, {\n        method: 'POST'\n      });\n      const data = await response.json();\n      if (response.ok) {\n        console.log('Dashboard cleared:', data);\n        setDashboardData([]); // Clear frontend dashboard data instantly\n        //  alert('Dashboard cleared!');\n      } else {\n        console.error('Failed to clear dashboard:', data);\n        //  alert(`Error clearing dashboard: ${data.detail || 'Unknown error'}`);\n      }\n    } catch (error) {\n      console.error('Network error clearing dashboard:', error);\n      // alert('Network error: Could not connect to backend to clear dashboard.');\n    }\n  }, []);\n\n  // --- Polling for Board State and Dashboard Data ---\n  useEffect(() => {\n    let intervalId;\n    const fetchSimulationData = async () => {\n      // Fetch board state\n      try {\n        const boardResponse = await fetch(`${API_BASE_URL}/simulation/status`);\n        const boardData = await boardResponse.json();\n        if (boardResponse.ok) {\n          // console.log('Fetched board state:', boardData);\n          setSimulationRunning(boardData.is_running);\n          // currentRound is not consistently provided by the backend's status yet, so omit for now.\n\n          // --- Compare and prepare for gliding animation ---\n          setLanes(prevLanes => {\n            const newLanes = boardData.lanes;\n            if (!prevLanes.length) return newLanes; // First load, no animation needed, just set initial state\n\n            const cardsToInitiateAnimation = []; // Store { card: oldCardData, newLaneId: newLaneId, startRect: Rect }\n\n            // Step 1: Create a quick lookup map for cards in the *previous* state\n            const oldCardsMap = new Map(); // Map of card.id -> oldCardObject\n            prevLanes.forEach(lane => {\n              lane.cards.forEach(card => {\n                oldCardsMap.set(card.id, card);\n              });\n            });\n\n            // Step 2: Iterate through cards in the *new* state to detect changes\n            for (const newLane of newLanes) {\n              for (const newCard of newLane.cards) {\n                const oldCard = oldCardsMap.get(newCard.id);\n\n                // Condition for triggering a glide animation:\n                // 1. The card existed in the previous state (`oldCard` is found).\n                // 2. Its current lane (`newCard.col`) is different from its previous lane (`oldCard.col`).\n                if (oldCard && oldCard.col !== newCard.col) {\n                  const cardElement = cardRefs.current.get(oldCard.id); // Try to get the DOM element of the OLD card\n\n                  // CRITICAL: Only attempt to animate if the old card's DOM element is *still present*\n                  // at its previous location when we poll.\n                  if (cardElement) {\n                    cardsToInitiateAnimation.push({\n                      card: oldCard,\n                      // Pass the OLD card data to the animation, to render the clone\n                      newLaneId: newCard.col,\n                      // The new column ID is the target lane ID\n                      startRect: cardElement.getBoundingClientRect() // Capture START position from the OLD element\n                    });\n                  } else {\n                    // This console.warn will now show only when the old element is *already* gone.\n                    // This means our polling isn't fast enough, or something else removed the ref.\n                    console.warn(`[Gliding-Fix] Old element for card ${oldCard.id} (from lane ${oldCard.col} to ${newCard.col}) not found for animation. Skipping glide.`);\n                  }\n                }\n              }\n            }\n\n            // Step 3: Now that all `startRect`s are captured, trigger `setFlyingAnimations`\n            // This is done *before* `setLanes` returns, but the animation itself\n            // won't complete until `endRect` is set after the next `requestAnimationFrame`.\n            setFlyingAnimations(currentFlying => {\n              const newAnimations = [];\n              cardsToInitiateAnimation.forEach(animData => {\n                newAnimations.push({\n                  id: `flying-${animData.card.id}-${Date.now()}`,\n                  // Unique ID for each animation instance\n                  card: animData.card,\n                  // This is the old card data for the clone\n                  startRect: animData.startRect,\n                  endRect: null // Will be set in requestAnimationFrame after React updates DOM\n                });\n              });\n              return [...currentFlying, ...newAnimations]; // Add new animations to existing ones\n            });\n\n            // Step 4: Return the new board state. React will then render this.\n            // This causes the actual cards to disappear from old position and appear in new.\n            const finalNewLanes = boardData.lanes;\n\n            // Step 5: Schedule getting `endRect` after React has updated the DOM\n            // `requestAnimationFrame` ensures this runs right before the browser's next paint.\n            requestAnimationFrame(() => {\n              setFlyingAnimations(currentFlying => currentFlying.map(anim => {\n                // Only process animations that have a startRect but no endRect yet\n                if (anim.startRect && anim.endRect === null) {\n                  const newCardInDOM = cardRefs.current.get(anim.card.id); // Find the actual card in its new position\n                  if (newCardInDOM) {\n                    const endRect = newCardInDOM.getBoundingClientRect();\n                    return {\n                      ...anim,\n                      endRect: endRect\n                    }; // Update with end position\n                  } else {\n                    // Card wasn't found in its new DOM position (e.g., moved to Done and removed from board)\n                    console.warn(`[Gliding-Fix] Card ${anim.card.id} not found in new DOM position for endRect. Cancelling animation clone.`);\n                    return null; // Mark for removal\n                  }\n                }\n                return anim; // Return already completed animations as is\n              }).filter(Boolean)); // Remove any null entries (cancelled animations)\n            });\n            return finalNewLanes; // This updates the React `lanes` state\n          }); // End of setLanes callback\n        } else {\n          console.error('Failed to fetch board state:', boardData);\n          setSimulationRunning(false);\n        }\n      } catch (error) {\n        console.error('Network error fetching board state:', error);\n        setSimulationRunning(false); // Assume simulation stopped if network fails\n      }\n\n      // Fetch dashboard data\n      try {\n        const dashboardResponse = await fetch(`${API_BASE_URL}/dashboard/data`);\n        const dashboardData = await dashboardResponse.json();\n        if (dashboardResponse.ok) {\n          // console.log('Fetched dashboard data:', dashboardData);\n          setDashboardData(dashboardData.dashboard_entries || []); // Ensure it's an array\n        } else {\n          console.error('Failed to fetch dashboard data:', dashboardData);\n        }\n      } catch (error) {\n        console.error('Network error fetching dashboard data:', error);\n      }\n    };\n\n    // Start polling if simulationRunning is true (or initially to get state)\n    // The interval speed is fixed here. Backend speed just controls backend ticking.\n    const pollingInterval = 1000; // Poll every 500ms (adjust as needed)\n\n    // Initial fetch when component mounts or simulationRunning status changes\n    fetchSimulationData();\n\n    // Set up interval only if simulation is meant to be running or we want continuous updates\n    intervalId = setInterval(fetchSimulationData, pollingInterval);\n\n    // Clear interval on component unmount or when simulation explicitly stops\n    return () => {\n      clearInterval(intervalId);\n      console.log('Polling interval cleared.');\n    };\n  }, [programmaticMoveCard]); // Re-run effect if programmaticMoveCard callback changes (unlikely)\n\n  // --- Render UI ---\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col p-8 bg-gray-50 min-h-screen\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-8 p-6 bg-white rounded-lg shadow-md max-w-full lg:max-w-4xl mx-auto\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-2xl font-bold text-gray-800 mb-4 border-b pb-2\",\n        children: \"Simulation Controls\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-gray-700 text-sm font-bold mb-2\",\n            children: \"Complexity:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 349,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            value: complexity\n            //onChange={(e) => setComplexity(parseInt(e.target.value) || 0)}\n            ,\n\n            onChange: e => {\n              const newValue = parseInt(e.target.value) || 0;\n              setComplexity(newValue);\n              console.log('Frontend: Complexity set to', newValue); // ADD THIS LOG\n            },\n            className: \"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",\n            min: \"1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-gray-700 text-sm font-bold mb-2\",\n            children: \"WIP Limit:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            value: wipLimit,\n            onChange: e => setWipLimit(parseInt(e.target.value) || 0),\n            className: \"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",\n            min: \"0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 368,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-gray-700 text-sm font-bold mb-2\",\n            children: \"Sim Speed (sec/step):\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 377,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            step: \"0.1\",\n            value: simSpeed,\n            onChange: e => setSimSpeed(parseFloat(e.target.value) || 0.0),\n            className: \"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",\n            min: \"0.1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 378,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 376,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-center space-x-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: startSimulation,\n          disabled: !isReady || simulationRunning,\n          className: `px-6 py-3 rounded-lg text-white font-bold transition-colors duration-200 ${!isReady || simulationRunning ? 'bg-gray-400 cursor-not-allowed' : 'bg-green-500 hover:bg-green-700'}`,\n          children: \"Start Simulation\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: stopSimulation,\n          disabled: !isReady || !simulationRunning,\n          className: `px-6 py-3 rounded-lg text-white font-bold transition-colors duration-200 ${!isReady || !simulationRunning ? 'bg-gray-400 cursor-not-allowed' : 'bg-red-500 hover:bg-red-700'}`,\n          children: \"Stop Simulation\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: clearDashboard,\n          disabled: !isReady,\n          className: `px-6 py-3 rounded-lg text-white font-bold transition-colors duration-200 ${!isReady ? 'bg-gray-400 cursor-not-allowed' : 'bg-yellow-500 hover:bg-yellow-700'}`,\n          children: \"Clear Dashboard\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 388,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex p-4 overflow-x-auto items-start bg-gray-100 rounded-lg shadow-inner flex-grow\",\n      children: lanes.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-center text-gray-500 w-full p-10\",\n        children: \"No board data available. Start simulation to load cards.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 11\n      }, this) : lanes.map(lane => /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: el => {\n          if (el) laneRefs.current.set(lane.id, el);else laneRefs.current.delete(lane.id);\n        },\n        className: \"w-80 p-4 rounded-lg shadow-inner flex-shrink-0 mr-4 bg-gray-200 min-h-[400px]\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-semibold mb-4 text-gray-800 border-b border-gray-300 pb-2\",\n          children: [lane.title, \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm text-gray-500\",\n            children: [\"WIP:\", lane.wip_limit]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 435,\n            columnNumber: 115\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 435,\n          columnNumber: 15\n        }, this), lane.cards.map((card, index) => {\n          const isFlyingClone = flyingAnimations.some(anim => anim.card.id === card.id && anim.endRect);\n          return /*#__PURE__*/_jsxDEV(Card, {\n            id: card.id,\n            text: card.birth_id ? `Card ${card.birth_id}` : card.id /* Use birth_id for display */,\n            laneId: card.col // Use card.col as laneId\n            ,\n            index: index,\n            ref: el => {\n              if (el) cardRefs.current.set(card.id, el);else cardRefs.current.delete(card.id);\n            },\n            style: {\n              visibility: isFlyingClone ? 'hidden' : 'visible',\n              backgroundColor: card.is_red ? '#ca0633' : '#ffffff'\n            }\n          }, card.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 439,\n            columnNumber: 19\n          }, this);\n        })]\n      }, lane.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-8 p-6 bg-white rounded-lg shadow-md max-w-full lg:max-w-4xl mx-auto\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-2xl font-bold text-gray-800 mb-4 border-b pb-2\",\n        children: \"Dashboard\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 460,\n        columnNumber: 9\n      }, this), dashboardData.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-500\",\n        children: \"Dashboard is empty. Run a simulation!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 462,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"overflow-x-auto\",\n        children: /*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"min-w-full divide-y divide-gray-200\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            className: \"bg-gray-50\",\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                children: \"Round\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 468,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                children: \"WIP Limit\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 469,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                children: \"Cycle Time (Red Card)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 470,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                children: \"Flow Efficiency\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 471,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                children: \"In Progress\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 472,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                children: \"Done\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 473,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                children: \"Throughput\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 474,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 467,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 466,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            className: \"bg-white divide-y divide-gray-200\",\n            children: dashboardData.map((entry, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [\" \", /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-3 py-2 whitespace-nowrap text-sm text-gray-900\",\n                children: entry.round\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 480,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-3 py-2 whitespace-nowrap text-sm text-gray-900\",\n                children: entry.wip_limit\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 480,\n                columnNumber: 105\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-3 py-2 whitespace-nowrap text-sm text-gray-900\",\n                children: entry.red_card_cycle_time\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 480,\n                columnNumber: 193\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-3 py-2 whitespace-nowrap text-sm text-gray-900\",\n                children: entry.flow_efficiency\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 480,\n                columnNumber: 291\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-3 py-2 whitespace-nowrap text-sm text-gray-900\",\n                children: entry.in_progress\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 480,\n                columnNumber: 385\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-3 py-2 whitespace-nowrap text-sm text-gray-900\",\n                children: entry.done\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 480,\n                columnNumber: 475\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-3 py-2 whitespace-nowrap text-sm text-gray-900\",\n                children: entry.throughput\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 480,\n                columnNumber: 558\n              }, this)]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 479,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 477,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 465,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 464,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 459,\n      columnNumber: 7\n    }, this), flyingAnimations.map(anim => anim.startRect && anim.endRect && /*#__PURE__*/_jsxDEV(FlyingCardAnimation, {\n      card: anim.card,\n      startRect: anim.startRect,\n      endRect: anim.endRect,\n      onAnimationEnd: handleAnimationEnd\n    }, anim.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 490,\n      columnNumber: 9\n    }, this))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 343,\n    columnNumber: 5\n  }, this);\n};\n_s(Board, \"przsNSjRpYQOFFBDyI5WRUusJls=\");\n_c = Board;\nexport default Board;\nvar _c;\n$RefreshReg$(_c, \"Board\");","map":{"version":3,"names":["React","useState","useCallback","useRef","useEffect","Lane","Card","FlyingCardAnimation","jsxDEV","_jsxDEV","API_BASE_URL","Board","_s","lanes","setLanes","dashboardData","setDashboardData","complexity","setComplexity","wipLimit","setWipLimit","simSpeed","setSimSpeed","simulationRunning","setSimulationRunning","currentRound","setCurrentRound","flyingAnimations","setFlyingAnimations","cardRefs","Map","laneRefs","isReady","setIsReady","timeoutId","setTimeout","console","log","clearTimeout","getCardById","cardId","lane","card","cards","find","c","id","programmaticMoveCard","targetLaneId","cardElement","current","get","targetLaneElement","warn","startRect","getBoundingClientRect","currentCardData","prev","Date","now","requestAnimationFrame","endCardElement","endRect","map","anim","filter","handleAnimationEnd","animatedCardId","setConfig","response","fetch","method","headers","body","JSON","stringify","wip_limit","speed","data","json","ok","error","startSimulation","stopSimulation","clearDashboard","intervalId","fetchSimulationData","boardResponse","boardData","is_running","prevLanes","newLanes","length","cardsToInitiateAnimation","oldCardsMap","forEach","set","newLane","newCard","oldCard","col","push","newLaneId","currentFlying","newAnimations","animData","finalNewLanes","newCardInDOM","Boolean","dashboardResponse","dashboard_entries","pollingInterval","setInterval","clearInterval","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","value","onChange","e","newValue","parseInt","target","min","step","parseFloat","onClick","disabled","ref","el","delete","title","index","isFlyingClone","some","text","birth_id","laneId","style","visibility","backgroundColor","is_red","entry","round","red_card_cycle_time","flow_efficiency","in_progress","done","throughput","onAnimationEnd","_c","$RefreshReg$"],"sources":["/Users/ralf/PyPrograms/KanbanFlow-Web/kanban-gui-test/src/components/Board.js"],"sourcesContent":["// src/components/Board.js\nimport React, { useState, useCallback, useRef, useEffect } from 'react';\nimport Lane from './Lane';\nimport Card from './Card';\nimport FlyingCardAnimation from './FlyingCardAnimation';\n\n// --- API Configuration ---\n// IMPORTANT: Use your FastAPI backend URL.\n// If running locally, it's usually http://127.0.0.1:8000\nconst API_BASE_URL = 'http://127.0.0.1:8000';\n\nconst Board = () => {\n  // --- React State for Board and Simulation Controls ---\n  const [lanes, setLanes] = useState([]); // Initial empty lanes, will be populated from backend\n  const [dashboardData, setDashboardData] = useState([]); // For the dashboard table\n\n  // Simulation Parameters state (for user input)\n  const [complexity, setComplexity] = useState(1);\n  const [wipLimit, setWipLimit] = useState(5);\n  const [simSpeed, setSimSpeed] = useState(1.0); // In seconds per step\n\n  const [simulationRunning, setSimulationRunning] = useState(false); // Tracks backend status\n  const [currentRound, setCurrentRound] = useState(0); // Tracks backend round\n\n  const [flyingAnimations, setFlyingAnimations] = useState([]);\n\n  // Refs for card elements for gliding animation\n  const cardRefs = useRef(new Map());\n  const laneRefs = useRef(new Map());\n\n  // Board readiness for first render (from previous step)\n  const [isReady, setIsReady] = useState(false);\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      setIsReady(true);\n      console.log('Board component and initial refs are likely ready.');\n    }, 100);\n    return () => clearTimeout(timeoutId);\n  }, []);\n\n  // --- Helper to get a card by its ID from current React lanes state ---\n  const getCardById = useCallback((cardId) => {\n    for (const lane of lanes) {\n      const card = lane.cards.find(c => c.id === cardId);\n      if (card) return card;\n    }\n    return null;\n  }, [lanes]);\n\n  // --- Programmatic Card Move (Gliding) ---\n  const programmaticMoveCard = useCallback((cardId, targetLaneId) => {\n    const cardElement = cardRefs.current.get(cardId);\n    const targetLaneElement = laneRefs.current.get(targetLaneId);\n\n    if (!cardElement || !targetLaneElement) {\n      console.warn(`[Gliding] Could not find element for card ${cardId} or lane ${targetLaneId}. Cannot animate.`);\n      return;\n    }\n\n    const startRect = cardElement.getBoundingClientRect();\n    const currentCardData = getCardById(cardId);\n\n    // If cardData is null (e.g. card moved off board), don't animate\n    if (!currentCardData) {\n        console.warn(`[Gliding] Card ${cardId} not found in current state, skipping animation.`);\n        return;\n    }\n\n    setFlyingAnimations(prev => [\n      ...prev,\n      {\n        id: `flying-${cardId}-${Date.now()}`, // Unique ID for each animation instance\n        card: currentCardData,\n        startRect: startRect,\n      }\n    ]);\n\n    // Schedule getting endRect after React re-renders the actual card\n    requestAnimationFrame(() => {\n      const endCardElement = cardRefs.current.get(cardId);\n      if (endCardElement) {\n        const endRect = endCardElement.getBoundingClientRect();\n        setFlyingAnimations(prev => prev.map(anim =>\n          anim.card.id === cardId && !anim.endRect\n            ? { ...anim, endRect: endRect }\n            : anim\n        ));\n      } else {\n        // If card disappeared (e.g., moved to Done and removed from board), clear animation\n        setFlyingAnimations(prev => prev.filter(anim => anim.card.id !== cardId));\n      }\n    });\n\n  }, [getCardById]);\n\n  // Callback for when a flying animation ends\n  const handleAnimationEnd = useCallback((animatedCardId) => {\n    setFlyingAnimations(prev => prev.filter(anim => anim.card.id !== animatedCardId));\n  }, []);\n\n  // --- API Calls to Python Backend ---\n\n  const setConfig = useCallback(async () => {\n    console.log(\"setConfig: Attempting to set simulation config...\"); // NEW LOG\n    try {\n      const response = await fetch(`${API_BASE_URL}/simulation/config`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ complexity, wip_limit: wipLimit, speed: simSpeed }),\n      });\n\nconsole.log(\"setConfig: Fetch request sent and response received.\"); // NEW LOG\n\n      const data = await response.json();\n      if (response.ok) {\n        console.log('Config set:', data);\n      //  alert('Simulation parameters updated!');\n      } else {\n        console.error('Failed to set config:', data);\n       // alert(`Error setting config: ${data.detail || 'Unknown error'}`);\n      }\n    } catch (error) {\n      console.error('Network error setting config:', error);\n      // alert('Network error: Could not connect to backend to set config.');\n    }\n  }, [complexity, wipLimit, simSpeed]);\n\n\n  const startSimulation = useCallback(async () => {\n\n    console.log(\"startSimulation: Attempting to start simulation...\"); // NEW LOG\n    try {\n      console.log(\"startSimulation: Calling setConfig...\"); // NEW LOG\n      // Ensure parameters are set first\n      await setConfig();\n      console.log(\"startSimulation: setConfig call finished.\"); // NEW LOG\n\n      const response = await fetch(`${API_BASE_URL}/simulation/start`, {\n        method: 'POST',\n      });\n      const data = await response.json();\n      if (response.ok) {\n        console.log('Simulation started:', data);\n        setSimulationRunning(true);\n       // alert('Simulation started!');\n      } else {\n        console.error('Failed to start simulation:', data);\n       // alert(`Error starting simulation: ${data.detail || 'Unknown error'}`);\n      }\n    } catch (error) {\n           console.error('startSimulation: Network error starting simulation or error from setConfig:', error); // NEW LOG\n    \n      //  alert('Network error: Could not connect to backend to start simulation.');\n    }\n  }, [setConfig]); // Depend on setConfig\n\n  const stopSimulation = useCallback(async () => {\n    console.log(\"Stopping simulation...\");\n    try {\n      const response = await fetch(`${API_BASE_URL}/simulation/stop`, {\n        method: 'POST',\n      });\n      const data = await response.json();\n      if (response.ok) {\n        console.log('Simulation stopped:', data);\n        setSimulationRunning(false);\n       // alert('Simulation stopped!');\n      } else {\n        console.error('Failed to stop simulation:', data);\n       // alert(`Error stopping simulation: ${data.detail || 'Unknown error'}`);\n      }\n    } catch (error) {\n      console.error('Network error stopping simulation:', error);\n     // alert('Network error: Could not connect to backend to stop simulation.');\n    }\n  }, []);\n\n  const clearDashboard = useCallback(async () => {\n    console.log(\"Clearing dashboard...\");\n    try {\n      const response = await fetch(`${API_BASE_URL}/dashboard/clear`, {\n        method: 'POST',\n      });\n      const data = await response.json();\n      if (response.ok) {\n        console.log('Dashboard cleared:', data);\n        setDashboardData([]); // Clear frontend dashboard data instantly\n      //  alert('Dashboard cleared!');\n      } else {\n        console.error('Failed to clear dashboard:', data);\n      //  alert(`Error clearing dashboard: ${data.detail || 'Unknown error'}`);\n      }\n    } catch (error) {\n      console.error('Network error clearing dashboard:', error);\n     // alert('Network error: Could not connect to backend to clear dashboard.');\n    }\n  }, []);\n\n  // --- Polling for Board State and Dashboard Data ---\n  useEffect(() => {\n    let intervalId;\n\n    const fetchSimulationData = async () => {\n      // Fetch board state\n      try {\n        const boardResponse = await fetch(`${API_BASE_URL}/simulation/status`);\n        const boardData = await boardResponse.json();\n        if (boardResponse.ok) {\n          // console.log('Fetched board state:', boardData);\n          setSimulationRunning(boardData.is_running);\n          // currentRound is not consistently provided by the backend's status yet, so omit for now.\n\n          // --- Compare and prepare for gliding animation ---\n          setLanes(prevLanes => {\n            const newLanes = boardData.lanes;\n            if (!prevLanes.length) return newLanes; // First load, no animation needed, just set initial state\n\n            const cardsToInitiateAnimation = []; // Store { card: oldCardData, newLaneId: newLaneId, startRect: Rect }\n\n            // Step 1: Create a quick lookup map for cards in the *previous* state\n            const oldCardsMap = new Map(); // Map of card.id -> oldCardObject\n            prevLanes.forEach(lane => {\n                lane.cards.forEach(card => {\n                    oldCardsMap.set(card.id, card);\n                });\n            });\n\n            // Step 2: Iterate through cards in the *new* state to detect changes\n            for (const newLane of newLanes) {\n                for (const newCard of newLane.cards) {\n                    const oldCard = oldCardsMap.get(newCard.id);\n\n                    // Condition for triggering a glide animation:\n                    // 1. The card existed in the previous state (`oldCard` is found).\n                    // 2. Its current lane (`newCard.col`) is different from its previous lane (`oldCard.col`).\n                    if (oldCard && oldCard.col !== newCard.col) {\n                        const cardElement = cardRefs.current.get(oldCard.id); // Try to get the DOM element of the OLD card\n\n                        // CRITICAL: Only attempt to animate if the old card's DOM element is *still present*\n                        // at its previous location when we poll.\n                        if (cardElement) {\n                            cardsToInitiateAnimation.push({\n                                card: oldCard, // Pass the OLD card data to the animation, to render the clone\n                                newLaneId: newCard.col, // The new column ID is the target lane ID\n                                startRect: cardElement.getBoundingClientRect() // Capture START position from the OLD element\n                            });\n                        } else {\n                            // This console.warn will now show only when the old element is *already* gone.\n                            // This means our polling isn't fast enough, or something else removed the ref.\n                            console.warn(`[Gliding-Fix] Old element for card ${oldCard.id} (from lane ${oldCard.col} to ${newCard.col}) not found for animation. Skipping glide.`);\n                        }\n                    }\n                }\n            }\n\n            // Step 3: Now that all `startRect`s are captured, trigger `setFlyingAnimations`\n            // This is done *before* `setLanes` returns, but the animation itself\n            // won't complete until `endRect` is set after the next `requestAnimationFrame`.\n            setFlyingAnimations(currentFlying => {\n                const newAnimations = [];\n                cardsToInitiateAnimation.forEach(animData => {\n                    newAnimations.push({\n                        id: `flying-${animData.card.id}-${Date.now()}`, // Unique ID for each animation instance\n                        card: animData.card, // This is the old card data for the clone\n                        startRect: animData.startRect,\n                        endRect: null // Will be set in requestAnimationFrame after React updates DOM\n                    });\n                });\n                return [...currentFlying, ...newAnimations]; // Add new animations to existing ones\n            });\n\n            // Step 4: Return the new board state. React will then render this.\n            // This causes the actual cards to disappear from old position and appear in new.\n            const finalNewLanes = boardData.lanes;\n\n            // Step 5: Schedule getting `endRect` after React has updated the DOM\n            // `requestAnimationFrame` ensures this runs right before the browser's next paint.\n            requestAnimationFrame(() => {\n                setFlyingAnimations(currentFlying => currentFlying.map(anim => {\n                    // Only process animations that have a startRect but no endRect yet\n                    if (anim.startRect && anim.endRect === null) {\n                        const newCardInDOM = cardRefs.current.get(anim.card.id); // Find the actual card in its new position\n                        if (newCardInDOM) {\n                            const endRect = newCardInDOM.getBoundingClientRect();\n                            return { ...anim, endRect: endRect }; // Update with end position\n                        } else {\n                            // Card wasn't found in its new DOM position (e.g., moved to Done and removed from board)\n                            console.warn(`[Gliding-Fix] Card ${anim.card.id} not found in new DOM position for endRect. Cancelling animation clone.`);\n                            return null; // Mark for removal\n                        }\n                    }\n                    return anim; // Return already completed animations as is\n                }).filter(Boolean)); // Remove any null entries (cancelled animations)\n            });\n\n            return finalNewLanes; // This updates the React `lanes` state\n          }); // End of setLanes callback\n\n        } else {\n          console.error('Failed to fetch board state:', boardData);\n          setSimulationRunning(false);\n        }\n      } catch (error) {\n        console.error('Network error fetching board state:', error);\n        setSimulationRunning(false); // Assume simulation stopped if network fails\n      }\n\n      // Fetch dashboard data\n      try {\n        const dashboardResponse = await fetch(`${API_BASE_URL}/dashboard/data`);\n        const dashboardData = await dashboardResponse.json();\n        if (dashboardResponse.ok) {\n          // console.log('Fetched dashboard data:', dashboardData);\n          setDashboardData(dashboardData.dashboard_entries || []); // Ensure it's an array\n        } else {\n          console.error('Failed to fetch dashboard data:', dashboardData);\n        }\n      } catch (error) {\n        console.error('Network error fetching dashboard data:', error);\n      }\n    };\n\n    // Start polling if simulationRunning is true (or initially to get state)\n    // The interval speed is fixed here. Backend speed just controls backend ticking.\n    const pollingInterval = 1000; // Poll every 500ms (adjust as needed)\n\n    // Initial fetch when component mounts or simulationRunning status changes\n    fetchSimulationData();\n\n    // Set up interval only if simulation is meant to be running or we want continuous updates\n    intervalId = setInterval(fetchSimulationData, pollingInterval);\n\n    // Clear interval on component unmount or when simulation explicitly stops\n    return () => {\n      clearInterval(intervalId);\n      console.log('Polling interval cleared.');\n    };\n  }, [programmaticMoveCard]); // Re-run effect if programmaticMoveCard callback changes (unlikely)\n\n\n  // --- Render UI ---\n  return (\n    <div className=\"flex flex-col p-8 bg-gray-50 min-h-screen\">\n      {/* Simulation Controls */}\n      <div className=\"mb-8 p-6 bg-white rounded-lg shadow-md max-w-full lg:max-w-4xl mx-auto\">\n        <h3 className=\"text-2xl font-bold text-gray-800 mb-4 border-b pb-2\">Simulation Controls</h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\n          <div>\n            <label className=\"block text-gray-700 text-sm font-bold mb-2\">Complexity:</label>\n            <input\n              type=\"number\"\n              value={complexity}\n              //onChange={(e) => setComplexity(parseInt(e.target.value) || 0)}\n             \n                onChange={(e) => {\n                const newValue = parseInt(e.target.value) || 0;\n                setComplexity(newValue);\n                console.log('Frontend: Complexity set to', newValue); // ADD THIS LOG\n              }}\n              \n              \n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              min=\"1\"\n            />\n          </div>\n          <div>\n            <label className=\"block text-gray-700 text-sm font-bold mb-2\">WIP Limit:</label>\n            <input\n              type=\"number\"\n              value={wipLimit}\n              onChange={(e) => setWipLimit(parseInt(e.target.value) || 0)}\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              min=\"0\"\n            />\n          </div>\n          <div>\n            <label className=\"block text-gray-700 text-sm font-bold mb-2\">Sim Speed (sec/step):</label>\n            <input\n              type=\"number\"\n              step=\"0.1\"\n              value={simSpeed}\n              onChange={(e) => setSimSpeed(parseFloat(e.target.value) || 0.0)}\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              min=\"0.1\"\n            />\n          </div>\n        </div>\n        <div className=\"flex justify-center space-x-4\">\n          <button\n            onClick={startSimulation}\n            disabled={!isReady || simulationRunning}\n            className={`px-6 py-3 rounded-lg text-white font-bold transition-colors duration-200 ${\n              !isReady || simulationRunning ? 'bg-gray-400 cursor-not-allowed' : 'bg-green-500 hover:bg-green-700'\n            }`}\n          >\n            Start Simulation\n          </button>\n          <button\n            onClick={stopSimulation}\n            disabled={!isReady || !simulationRunning}\n            className={`px-6 py-3 rounded-lg text-white font-bold transition-colors duration-200 ${\n              !isReady || !simulationRunning ? 'bg-gray-400 cursor-not-allowed' : 'bg-red-500 hover:bg-red-700'\n            }`}\n          >\n            Stop Simulation\n          </button>\n          <button\n            onClick={clearDashboard}\n            disabled={!isReady}\n            className={`px-6 py-3 rounded-lg text-white font-bold transition-colors duration-200 ${\n              !isReady ? 'bg-gray-400 cursor-not-allowed' : 'bg-yellow-500 hover:bg-yellow-700'\n            }`}\n          >\n            Clear Dashboard\n          </button>\n        </div>\n      </div>\n\n      {/* Kanban Board Display */}\n      <div className=\"flex p-4 overflow-x-auto items-start bg-gray-100 rounded-lg shadow-inner flex-grow\">\n        {lanes.length === 0 ? (\n          <p className=\"text-center text-gray-500 w-full p-10\">\n            No board data available. Start simulation to load cards.\n          </p>\n        ) : (\n          lanes.map((lane) => (\n            <div\n              key={lane.id}\n              ref={el => {\n                if (el) laneRefs.current.set(lane.id, el);\n                else laneRefs.current.delete(lane.id);\n              }}\n              className=\"w-80 p-4 rounded-lg shadow-inner flex-shrink-0 mr-4 bg-gray-200 min-h-[400px]\"\n            >\n              <h2 className=\"text-xl font-semibold mb-4 text-gray-800 border-b border-gray-300 pb-2\">{lane.title} <span className=\"text-sm text-gray-500\">WIP:{lane.wip_limit}</span></h2>\n              {lane.cards.map((card, index) => {\n                const isFlyingClone = flyingAnimations.some(anim => anim.card.id === card.id && anim.endRect);\n                return (\n                  <Card\n                    key={card.id}\n                    id={card.id}\n                    text={card.birth_id ? `Card ${card.birth_id}` : card.id} /* Use birth_id for display */\n                    laneId={card.col} // Use card.col as laneId\n                    index={index}\n                    ref={el => {\n                      if (el) cardRefs.current.set(card.id, el);\n                      else cardRefs.current.delete(card.id);\n                    }}\n                    style={{ visibility: isFlyingClone ? 'hidden' : 'visible', backgroundColor: card.is_red ? '#ca0633' : '#ffffff' }}\n                  />\n                );\n              })}\n            </div>\n          ))\n        )}\n      </div>\n\n      {/* Dashboard Table */}\n      <div className=\"mt-8 p-6 bg-white rounded-lg shadow-md max-w-full lg:max-w-4xl mx-auto\">\n        <h3 className=\"text-2xl font-bold text-gray-800 mb-4 border-b pb-2\">Dashboard</h3>\n        {dashboardData.length === 0 ? (\n          <p className=\"text-gray-500\">Dashboard is empty. Run a simulation!</p>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-gray-200\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Round</th>\n                  <th className=\"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">WIP Limit</th>\n                  <th className=\"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Cycle Time (Red Card)</th>\n                  <th className=\"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Flow Efficiency</th>\n                  <th className=\"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">In Progress</th>\n                  <th className=\"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Done</th>\n                  <th className=\"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Throughput</th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {dashboardData.map((entry, index) => (\n                  <tr key={index}> {/* Using index as key is okay for static lists, but prefer unique IDs if available */}\n                    <td className=\"px-3 py-2 whitespace-nowrap text-sm text-gray-900\">{entry.round}</td><td className=\"px-3 py-2 whitespace-nowrap text-sm text-gray-900\">{entry.wip_limit}</td><td className=\"px-3 py-2 whitespace-nowrap text-sm text-gray-900\">{entry.red_card_cycle_time}</td><td className=\"px-3 py-2 whitespace-nowrap text-sm text-gray-900\">{entry.flow_efficiency}</td><td className=\"px-3 py-2 whitespace-nowrap text-sm text-gray-900\">{entry.in_progress}</td><td className=\"px-3 py-2 whitespace-nowrap text-sm text-gray-900\">{entry.done}</td><td className=\"px-3 py-2 whitespace-nowrap text-sm text-gray-900\">{entry.throughput}</td></tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </div>\n\n      {/* Render flying animations on top of everything */}\n      {flyingAnimations.map(anim => anim.startRect && anim.endRect && (\n        <FlyingCardAnimation\n          key={anim.id}\n          card={anim.card}\n          startRect={anim.startRect}\n          endRect={anim.endRect}\n          onAnimationEnd={handleAnimationEnd}\n        />\n      ))}\n    </div>\n  );\n};\n\nexport default Board;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}